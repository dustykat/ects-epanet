
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3 EPANET Programmers Toolkit &#8212; Hydraulic Network Simulation with EPANET and Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lessons/lesson03/epanet-toolkit';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.2 EPANET (Examples 1 and 2) using the Toolkit" href="epanet-rulesGUI.html" />
    <link rel="prev" title="2.5 EPANET Control Rules" href="../lesson02/epanet-rules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Hydraulic Network Simulation with EPANET and Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Hydraulic Network Simulation with EPANET and Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    About this book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lesson01/introduction.html">1 Hydraulic Networks and Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lesson01/hydraulic-networks.html">1.2 Network Hydraulics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson01/pythonjupyter.html">1.3 Python/Jupyter Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson01/pythonhydraulics.html">1.4 Hydraulics in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson01/pythonhydraulicsmodule.html">1.5 The <code class="docutils literal notranslate"><span class="pre">pipenet</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson01/pythonpumpingmodule.html">1.6 Pumps</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lesson02/epanet-classic.html">2 EPANET Intro/Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lesson02/epanet-gui.html">2.2 EPANET GUI Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson02/epanet-eps.html">2.3 Extended period simulation (EPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson02/epanet-watq.html">2.4 Water Quality Simulation in EPANET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson02/epanet-rules.html">2.5 EPANET Control Rules</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">3 EPANET Programmers Toolkit</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="epanet-rulesGUI.html">3.2 EPANET (Examples 1 and 2) using the Toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="epanet-rulesCLI.html">3.3 EPANET (Examples 3-5) using the Toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="epanet-rulesAPI.html">3.4 EPANET Control Rules using the Toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="epanet-sensors.html">3.5 EPANET Sensors Integration</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lesson04/epanet-future-CandC1.html">4 Command and Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lesson04/epanet-future-CandC2.html">4.2 CandC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson04/epanet-future-CandC3.html">4.X Build Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson04/epanet-future.html">4.4 Unsolved Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson04/epanet-exam.html">4.5 EPANET Exam</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/lesson03/epanet-toolkit.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lessons/lesson03/epanet-toolkit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3 EPANET Programmers Toolkit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose">Purpose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-on-a-raspberry-pi">Installing on a Raspberry Pi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-source-files">Download source files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-shared-object-library">Build a shared object library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-the-library-to-the-working-directory">Copy the library to the working directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-run-your-scripts-to-implement-epanet-from-python">Write and run your scripts to implement EPANET from python.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="epanet-programmers-toolkit">
<h1>3 EPANET Programmers Toolkit<a class="headerlink" href="#epanet-programmers-toolkit" title="Link to this heading">#</a></h1>
<p>The EPANET Programmer’s Toolkit is a software applications programming interface (API) designed to facilitate the analysis and simulation of water distribution networks. Developed by the United States Environmental Protection Agency (EPA), EPANET is widely recognized as a comprehensive and reliable hydraulic and water quality modeling tool. The EPANET Programmer’s Toolkit offers engineers and researchers the ability to harness the full potential of EPANET’s capabilities, providing a platform for advanced water network analysis and optimization, directly accessing the computation engine without requiring the Graphical User Interface (GUI), or running the program in a batch mode with a prebuilt input file.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The EPANET Programmer’s Toolkit provides essential functions that allow users to manipulate EPANET models and retrieve critical information for hydraulic and water quality analysis. With the toolkit, users can access network data such as pipe and node properties, demand patterns, and control settings. This information can be modified or updated programmatically, enabling engineers to conduct what-if scenarios, optimize system design, and assess the impact of various operational strategies on network performance.</p>
<p>One of the toolkit’s key features is its ability to perform hydraulic and water quality simulations. Users can dynamically simulate water flow and pressure behavior in the network, enabling accurate prediction of system performance under different operating conditions. Moreover, the toolkit allows for the analysis of water quality parameters, such as chlorine concentration and contaminant transport, aiding in the evaluation of water safety and compliance with regulatory standards.</p>
<p>The EPANET Programmer’s Toolkit empowers water industry professionals to tackle complex water network challenges with greater efficiency and accuracy. By leveraging its capabilities, engineers can optimize pipe sizing, evaluate system resilience, and assess the impact of infrastructure changes on network performance. The toolkit’s ability to perform advanced simulations and analysis aids in the identification of potential issues, facilitating proactive decision-making and improving overall water network management. Furthermore, the EPANET Programmer’s Toolkit plays a crucial role in supporting research and innovation in the field of water distribution system analysis, fostering the development of new methodologies and solutions to address emerging challenges in water management.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>link to EPANET toolkit description here :::</p>
</div>
</section>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Link to this heading">#</a></h2>
<p>The primary purpose of the EPANET Programmer’s Toolkit is to enhance the functionality of EPANET and enable users to access its full potential in water distribution network analysis. The Toolkit serves as an <strong>interface</strong> that allows engineers and researchers to programmatically access and manipulate EPANET models, retrieve critical information, and perform hydraulic and water quality simulations without having to access the model through the Graphical User Interface (GUI). By providing essential modeling access functions, integration capabilities, and customization options, the toolkit enables analysts to conduct in-depth analysis, optimize system design, and evaluate the performance of water networks under various operational conditions.</p>
<p>The EPANET Programmer’s Toolkit supports integration with various programming languages, including C, C++, and Python, making it end-user adaptable to different software development environments. This flexibility allows engineers and researchers to leverage their preferred programming languages and frameworks, facilitating seamless integration with existing tools and workflows. Additionally, the toolkit’s extensive Application Programming Interface (API) documentation and code examples provide valuable resources for developers, enabling them to extend EPANET’s functionality and customize the software to meet specific project requirements.</p>
</section>
<section id="installing-on-a-raspberry-pi">
<h2>Installing on a Raspberry Pi<a class="headerlink" href="#installing-on-a-raspberry-pi" title="Link to this heading">#</a></h2>
<p>This section is specific to my development computer - the process is:</p>
<ol class="arabic simple">
<li><p>Download source files.</p></li>
<li><p>Build a shared object library.</p></li>
<li><p>Copy the library (or path to the library) into a working directory where you intend to run scripts.</p></li>
<li><p>Write and run your scripts to implement EPANET from python.</p></li>
</ol>
<section id="download-source-files">
<h3>Download source files<a class="headerlink" href="#download-source-files" title="Link to this heading">#</a></h3>
<p>Easiest is to create a directory, navigate to that directory, then clone the GitHub repository.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># As regular user or root user</span>
<span class="n">mkdir</span> <span class="n">en2toolkit</span>
<span class="n">cd</span> <span class="n">en2toolkit</span> 
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">OpenWaterAnalytics</span><span class="o">/</span><span class="n">EPANET</span><span class="o">.</span><span class="n">git</span>  <span class="c1">#clone the remote into the directory</span>
</pre></div>
</div>
<p>After the repository is cloned, step 1 above is complete</p>
</section>
<section id="build-a-shared-object-library">
<h3>Build a shared object library<a class="headerlink" href="#build-a-shared-object-library" title="Link to this heading">#</a></h3>
<p>From here need to work as superuser, so either change to root or use sudoprefix to the directives. I switched to the root user because my regular user cannot issue superuser commands.  Then issue the <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">..</span></code> directive to compile the objects for linking into the package.  After that completes then issue the <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">--build</span> <span class="pre">.</span> <span class="pre">--config</span> <span class="pre">Release</span></code> directive and let it run to (hopefully successful) completion.</p>
<p><img alt="" src="../../_images/buildtools1of2.png" /></p>
<p>After that completes then the library is found in the <code class="docutils literal notranslate"><span class="pre">\lib</span></code> directory.  Simply copy it into the work directory where you want to model.  A symbolic link added into the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable is another way to proceede.</p>
<p><img alt="" src="../../_images/buildtools2of2.png" /></p>
<p>Now to test the build of the shared object modules.  Import the interface module (listing below) which is stored as a file in our workspace.</p>
<p><a class="reference external" href="http://freeswmm.ddns.net/ects-epanet/ects-epanet-notes/lessons/lesson01/pipenet.py">epamodule.py (from OWA GitHub)</a> This is a copy from my server - specificially modified for my Raspberry Pi - the mods are in the first few lines; i left notes!</p>
<p><a class="reference external" href="https://github.com/OpenWaterAnalytics">link to OWA GitHub</a> you may find you can get the <code class="docutils literal notranslate"><span class="pre">EPyT</span></code> repository to work or you - it essentially is aimed at same end goal as this course, but has some of the graphics details better worked out.</p>
</section>
<section id="copy-the-library-to-the-working-directory">
<h3>Copy the library to the working directory<a class="headerlink" href="#copy-the-library-to-the-working-directory" title="Link to this heading">#</a></h3>
<p>For my example herein, I copied the build into:
<code class="docutils literal notranslate"><span class="pre">http://ects-epanet/ects-epanet-notes/lessons/lesson03/</span></code></p>
<p>I also copied two EPANET input files <code class="docutils literal notranslate"><span class="pre">Net1.inp</span></code> and <code class="docutils literal notranslate"><span class="pre">Net1g.inp</span></code></p>
<p>The listing below shows the directory, you can see the shared object library at the end of the listing, as well as the two input files for subsequent examples.  Also note the presence of a file named <code class="docutils literal notranslate"><span class="pre">epamodule.py</span></code> which is used below to access the toolkit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>ls<span class="w"> </span>-la
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 1584
drwxr-xr-x 10 sensei sensei   4096 Feb 28 21:46 .
drwxr-xr-x  7 sensei sensei   4096 Feb 28 21:46 ..
drwxr-xr-x  2 sensei sensei   4096 Feb 28 21:46 .ipynb_checkpoints
-rw-r--r--  1 sensei sensei  31504 Feb 28 21:46 ICTSummerSchool2023.ipynb.bak
-rw-r--r--  1 sensei sensei   3732 Feb 28 21:46 Junk.rpt
-rw-r--r--  1 sensei sensei   6304 Feb 28 21:46 Net1.inp
-rw-r--r--  1 sensei sensei  46587 Feb 28 21:46 Net1.out
-rw-r--r--  1 sensei sensei  42849 Feb 28 21:46 Net1.rpt
-rw-r--r--  1 sensei sensei   6305 Feb 28 21:46 Net1g.inp
-rw-r--r--  1 sensei sensei  46674 Feb 28 21:46 Net1g.rpt
drwxr-xr-x  2 sensei sensei   4096 Feb 28 21:47 __pycache__
-rw-r--r--  1 sensei sensei 387806 Feb 28 21:46 buildtools1of2.png
-rw-r--r--  1 sensei sensei 402767 Feb 28 21:46 buildtools2of2.png
-rw-r--r--  1 sensei sensei    169 Feb 28 21:46 enlkyr5b
-rw-r--r--  1 sensei sensei     69 Feb 28 21:46 ensYZnxU
-rw-r--r--  1 sensei sensei     69 Feb 28 21:46 enxPe9Sj
-rw-r--r--  1 sensei sensei  32610 Feb 28 21:46 epamodule.py
-rw-r--r--  1 sensei sensei   5227 Feb 28 21:46 epanet-rules.ipynb.bak
-rw-r--r--  1 sensei sensei   9010 Feb 28 21:46 epanet-rulesAPI.ipynb
-rw-r--r--  1 sensei sensei  38834 Feb 28 21:46 epanet-rulesCLI.ipynb
-rw-r--r--  1 sensei sensei  33946 Feb 28 21:46 epanet-rulesGUI.ipynb
-rw-r--r--  1 sensei sensei    779 Feb 28 21:46 epanet-sensors.ipynb
-rw-r--r--  1 sensei sensei  16736 Feb 28 21:46 epanet-toolkit.ipynb
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:46 ex1-cr
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:48 ex1-tk
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:46 ex2-tk
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:46 ex3-tk
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:46 ex4-tk
drwxr-xr-x  3 sensei sensei   4096 Feb 28 21:46 ex5-tk
-rw-r--r--  1 sensei sensei  15189 Feb 28 21:46 example2.inp
-rw-r--r--  1 sensei sensei    572 Feb 28 21:46 example2.rpt
-rwxr-xr-x  1 sensei sensei 400904 Feb 28 21:46 libepanet2.so
</pre></div>
</div>
</div>
</div>
</section>
<section id="write-and-run-your-scripts-to-implement-epanet-from-python">
<h3>Write and run your scripts to implement EPANET from python.<a class="headerlink" href="#write-and-run-your-scripts-to-implement-epanet-from-python" title="Link to this heading">#</a></h3>
<p>Below we demonstrate the last step, to write and run scripts that implement EPANET from our iPython kernel.</p>
<p>First import the <code class="docutils literal notranslate"><span class="pre">epamodule.py</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">epamodule</span> <span class="k">as</span> <span class="nn">em</span>  <span class="c1"># import the package</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">epamodule</span> <span class="k">as</span> <span class="nn">em</span>  <span class="c1"># import the package</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">ects</span><span class="o">-</span><span class="n">epanet</span><span class="o">/</span><span class="n">ects</span><span class="o">-</span><span class="n">epanet</span><span class="o">-</span><span class="n">notes</span><span class="o">/</span><span class="n">lessons</span><span class="o">/</span><span class="n">lesson03</span><span class="o">/</span><span class="n">epamodule</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">12</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">_plat</span><span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="k">if</span> <span class="n">_plat</span><span class="o">==</span><span class="s1">&#39;Linux&#39;</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">12</span>   <span class="n">_lib</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="s2">&quot;./libepanet2.so&quot;</span><span class="p">)</span> <span class="c1"># For My Raspberry Pi</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="c1">##  _lib = ctypes.CDLL(&quot;./en2tools.so.1.5.0&quot;)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1">##  _lib = ctypes.CDLL(&quot;./epanet2toolkit.so&quot;)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">elif</span> <span class="n">_plat</span><span class="o">==</span><span class="s1">&#39;Windows&#39;</span><span class="p">:</span>

<span class="nn">File /usr/lib/python3.10/ctypes/__init__.py:374,</span> in <span class="ni">CDLL.__init__</span><span class="nt">(self, name, mode, handle, use_errno, use_last_error, winmode)</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FuncPtr</span> <span class="o">=</span> <span class="n">_FuncPtr</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span> <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">374</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="n">_dlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="n">handle</span>

<span class="ne">OSError</span>: ./libepanet2.so: cannot open shared object file: No such file or directory
</pre></div>
</div>
</div>
</div>
<p>Then run an example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">em</span><span class="o">.</span><span class="n">ENepanet</span><span class="p">(</span><span class="s2">&quot;./ex1-tk/EX1tk.inp&quot;</span><span class="p">,</span> <span class="s2">&quot;./ex1-tk/EX1yk-live.rpt&quot;</span><span class="p">)</span> <span class="c1"># runs a complete simulation. input file must exist and have contents.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>cat<span class="w"> </span>./ex1-tk/EX1yk-live.rpt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Page 1                                    Thu Aug  3 09:44:33 2023

  ******************************************************************
  *                           E P A N E T                          *
  *                   Hydraulic and Water Quality                  *
  *                   Analysis for Pipe Networks                   *
  *                         Version 2.2                            *
  ******************************************************************
  
   
      Input Data File ................... ./ex1-tk/EX1tk.inp
      Number of Junctions................ 1
      Number of Reservoirs............... 1
      Number of Tanks ................... 0
      Number of Pipes ................... 1
      Number of Pumps ................... 0
      Number of Valves .................. 0
      Headloss Formula .................. Darcy-Weisbach
      Nodal Demand Model ................ DDA
      Hydraulic Timestep ................ 1.00 hrs
      Hydraulic Accuracy ................ 0.001000
      Status Check Frequency ............ 2
      Maximum Trials Checked ............ 10
      Damping Limit Threshold ........... 0.000000
      Maximum Trials .................... 40
      Quality Analysis .................. None
      Specific Gravity .................. 1.00
      Relative Kinematic Viscosity ...... 1.00
      Relative Chemical Diffusivity ..... 1.00
      Demand Multiplier ................. 1.00
      Total Duration .................... 0.00 hrs
      Reporting Criteria:
         All Nodes
         All Links
   
  Analysis begun Thu Aug  3 09:44:33 2023

   
  Node Results:
  ----------------------------------------------
                     Demand      Head  Pressure
  Node                  cfs        ft       psi
  ----------------------------------------------
  2                  295.00     26.93     11.67
  R1                -295.00    100.00      0.00  Reservoir
   
   
  Link Results:
  ----------------------------------------------
                       Flow  Velocity  Headloss
  Link                  cfs       fps   /1000ft
  ----------------------------------------------
  frenchy            295.00     15.02      7.31
   
  Analysis ended Thu Aug  3 09:44:33 2023
</pre></div>
</div>
</div>
</div>
<p>Now same example but more granular control.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Open the EPANET toolkit &amp; hydraulics solver   </span>
<span class="n">em</span><span class="o">.</span><span class="n">ENopen</span><span class="p">(</span><span class="s2">&quot;Net1g.inp&quot;</span><span class="p">,</span> <span class="s2">&quot;Net1g.rpt&quot;</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENopenH</span><span class="p">()</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENsolveH</span><span class="p">()</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENsaveH</span><span class="p">()</span> <span class="c1"># need to save to a binary file before write</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENcloseH</span><span class="p">()</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENopenQ</span><span class="p">()</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENsolveQ</span><span class="p">()</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENreport</span><span class="p">()</span> <span class="c1"># now write report</span>
<span class="c1"># Close hydraulics solver &amp; toolkit */</span>
<span class="n">em</span><span class="o">.</span><span class="n">ENclose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/OpenWaterAnalytics/epanet-python/">OpenWaterAnalytics(epanet-python)</a> The GitHub source for the <code class="docutils literal notranslate"><span class="pre">epamodule.py</span></code> above.</p></li>
<li><p><a class="github reference external" href="https://github.com/OpenWaterAnalytics/epanet/">OpenWaterAnalytics/epanet</a> The GitHub source for the code and build instructions for the shared object library above.</p></li>
<li><p><a class="reference external" href="https://www.epa.gov/water-research/epanet">EPANET (EPA website)</a>  Links to current EPA distributed EPANET programs and source files.</p></li>
<li><p><a class="reference external" href="https://github.com/USEPA/EPANET2.2">EPANET2.2</a>  EPA GitHub source.</p></li>
<li><p><a class="reference external" href="https://pypi.org/project/EPANETTOOLS/">EPANETTOOLS1.0.0 (A pypi.org package) </a>  A package manager for EPANETTOOLS.</p></li>
<li><p><a class="reference external" href="http://#">mycopy</a> Link to modified copy of <code class="docutils literal notranslate"><span class="pre">epamodule.py</span></code></p></li>
<li><p><a class="reference external" href="http://#">Net1.inp</a> Link to modified copy of</p></li>
<li><p><a class="reference external" href="http://#">Net1g.inp</a> Link to modified copy of</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of these sites cross-share content, so whether using OWA or EPA official you are likely getting the same program; if its use is for some official capacity (like a water utility) use the EPA sites as your source.</p>
</div>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://freeswmm.ddns.net/ects-epanet/ects-epanet-notes/lessons/lesson03">Directory with epamodule.py and libepanet2.so (for a Ubuntu/Raspberry Pi)</a>  You probably have to build the <code class="docutils literal notranslate"><span class="pre">.so</span></code> on your own machine - but you can at least examine the structure here</p></li>
<li><p><a class="reference external" href="http://freeswmm.ddns.net/ects-epanet/en2/">Directory of my <code class="docutils literal notranslate"><span class="pre">en2</span></code> on a raspberry pi</a>.  Again you probably have to do own builds - but you can examine structure.</p></li>
</ol>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lessons/lesson03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../lesson02/epanet-rules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2.5 EPANET Control Rules</p>
      </div>
    </a>
    <a class="right-next"
       href="epanet-rulesGUI.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3.2 EPANET (Examples 1 and 2) using the Toolkit</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose">Purpose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-on-a-raspberry-pi">Installing on a Raspberry Pi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-source-files">Download source files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-shared-object-library">Build a shared object library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy-the-library-to-the-working-directory">Copy the library to the working directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-and-run-your-scripts-to-implement-epanet-from-python">Write and run your scripts to implement EPANET from python.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Theodore G. Cleveland, Ph.D., P.E., M.ASCE, F.EWRI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>